syntax = "proto3";

import "google/protobuf/empty.proto";
package discoverd;

option go_package = "github.com/untangle/golang-shared/structs/protocolbuffers/Discoverd";


service Disoveryd {
    rpc RequestAllEntries (google.protobuf.Empty) returns (RequestResponse) {};
    rpc ScanNet (ScanNetRequest) returns (RequestResponse) {};
    rpc ScanHost (ScanHostRequest) returns (RequestResponse) {};
  }

enum ResponseCode {
    UNKNOWN = 0;
    OK = 1;
    ERROR = 2;
    INVALID_REQUEST = 3;
};

message RequestResponse {
    ResponseCode result = 1;
}

// param: net is a string in CIDR notation
message ScanNetRequest {
    repeated string net = 1;
}

// param: host is a string in host/ip notation
message ScanHostRequest {
    repeated string host = 1;
}

message DiscoveryEntry {
    string macAddress = 1;
    string IPv4Address = 2;
    int64 LastUpdate = 3;
    LLDP lldp = 10;
    ARP arp = 11;
    NMAP nmap = 12;
}

message LLDP {
        // Chassis
        string sysName = 1;
        string sysDesc = 2;
        repeated LLDPCapabilities chassisCapabilities = 3;
        // LLDP-MED
        string deviceType = 4;
        repeated LLDPCapabilities medCapabilities = 5;
        // LLDP-MED-DEVICE
        string inventoryHWRev = 6;
        string inventorySoftRev = 7;
        string inventorySerial = 8;
        string inventoryAssetTag = 9;
        string inventoryModel = 10;
        string inventoryVendor = 11;
}

message LLDPCapabilities {
    string capability = 1;
    bool enabled = 2;
}

message ARP {
     string ip = 1;
     string mac = 2;
}

message NMAP {
    repeated NMAPPorts openPorts = 1;
}

message NMAPPorts {
     int32 port = 1;
     string protocol = 2;
     string state = 3; 
}